<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- InstanceBegin template="/Templates/MovieLab_template.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<link rel="Shortcut Icon" href="/images/ml_icon.ico" />
<!-- InstanceBeginEditable name="doctitle" -->
<title>Avails Validator - MovieLabs</title>
<!-- InstanceEndEditable -->
<!-- InstanceBeginEditable name="head" -->
<!-- InstanceEndEditable -->
<style type="text/css">
<!--
body {
	margin-left: 0px;
	margin-top: 0px;
	margin-right: 0px;
	margin-bottom: 0px;
}
-->
</style>
<!-- InstanceBeginEditable name="Scripts" -->
<script type="text/JavaScript">
<!-- fill in scripts here -->
	function MM_swapImgRestore() { //v3.0
		var i, x, a = document.MM_sr;
		for (i = 0; a && i < a.length && (x = a[i]) && x.oSrc; i++)
			x.src = x.oSrc;
	}

	function MM_preloadImages() { //v3.0
		var d = document;
		if (d.images) {
			if (!d.MM_p)
				d.MM_p = new Array();
			var i, j = d.MM_p.length, a = MM_preloadImages.arguments;
			for (i = 0; i < a.length; i++)
				if (a[i].indexOf("#") != 0) {
					d.MM_p[j] = new Image;
					d.MM_p[j++].src = a[i];
				}
		}
	}

	function MM_findObj(n, d) { //v4.01
		var p, i, x;
		if (!d)
			d = document;
		if ((p = n.indexOf("?")) > 0 && parent.frames.length) {
			d = parent.frames[n.substring(p + 1)].document;
			n = n.substring(0, p);
		}
		if (!(x = d[n]) && d.all)
			x = d.all[n];
		for (i = 0; !x && i < d.forms.length; i++)
			x = d.forms[i][n];
		for (i = 0; !x && d.layers && i < d.layers.length; i++)
			x = MM_findObj(n, d.layers[i].document);
		if (!x && d.getElementById)
			x = d.getElementById(n);
		return x;
	}

	function MM_swapImage() { //v3.0
		var i, j = 0, x, a = MM_swapImage.arguments;
		document.MM_sr = new Array;
		for (i = 0; i < (a.length - 2); i += 3)
			if ((x = MM_findObj(a[i])) != null) {
				document.MM_sr[j++] = x;
				if (!x.oSrc)
					x.oSrc = x.src;
				x.src = a[i + 2];
			}
	}
//-->
</script>
<style type="text/css">
<!--
.style1 {
	font-size: x-large
}
-->
</style>
<!-- InstanceEndEditable -->
<script type="text/JavaScript">
<!--
	function MM_swapImgRestore() { //v3.0
		var i, x, a = document.MM_sr;
		for (i = 0; a && i < a.length && (x = a[i]) && x.oSrc; i++)
			x.src = x.oSrc;
	}

	function MM_preloadImages() { //v3.0
		var d = document;
		if (d.images) {
			if (!d.MM_p)
				d.MM_p = new Array();
			var i, j = d.MM_p.length, a = MM_preloadImages.arguments;
			for (i = 0; i < a.length; i++)
				if (a[i].indexOf("#") != 0) {
					d.MM_p[j] = new Image;
					d.MM_p[j++].src = a[i];
				}
		}
	}

	function MM_findObj(n, d) { //v4.01
		var p, i, x;
		if (!d)
			d = document;
		if ((p = n.indexOf("?")) > 0 && parent.frames.length) {
			d = parent.frames[n.substring(p + 1)].document;
			n = n.substring(0, p);
		}
		if (!(x = d[n]) && d.all)
			x = d.all[n];
		for (i = 0; !x && i < d.forms.length; i++)
			x = d.forms[i][n];
		for (i = 0; !x && d.layers && i < d.layers.length; i++)
			x = MM_findObj(n, d.layers[i].document);
		if (!x && d.getElementById)
			x = d.getElementById(n);
		return x;
	}

	function MM_swapImage() { //v3.0
		var i, j = 0, x, a = MM_swapImage.arguments;
		document.MM_sr = new Array;
		for (i = 0; i < (a.length - 2); i += 3)
			if ((x = MM_findObj(a[i])) != null) {
				document.MM_sr[j++] = x;
				if (!x.oSrc)
					x.oSrc = x.src;
				x.src = a[i + 2];
			}
	}
//-->
</script>
<style type="text/css">
<!--
.linkwhite {
	color: #FFFFFF
}

.linkgray {
	color: #333333
}
-->
</style>
<style>
.imgDiv {
	text-align: center;
}

.imgCaption {
	font-family: Geneva, Arial, Helvetica, sans-serif;
	color: #E7AF32;
	font-weight: bold;
	line-height: 16px;
	padding-top: 2px;
	margin: 20;
}
</style>
<link href="../../../../style/movielab3.css" rel="stylesheet"
	type="text/css" />
<link href="../../../../style/drop-down-menu2.css" rel="stylesheet"
	type="text/css" />
</head>

<body
	onload="MM_preloadImages('../../../../images/nav2/nav_initiatives_RO.gif','../../../../images/nav2/nav_aboutus_RO.gif','../../../../images/nav2/nav_specsstandards_RO.gif','../../../../images/nav2/nav_pitchus_RO.gif')">
	<table width="800" border="0" align="center" cellpadding="0"
		cellspacing="0">
		<tr>
			<td><table width="100%" height="130" border="0" cellpadding="0"
					cellspacing="0">
					<tr>
						<td width="200" valign="top"><a href="../../../../index.html"><img
								src="../../../../images/logo_movielabs.jpg" alt="MovieLab"
								width="200" height="130" border="0" /></a></td>
						<td width="600" background="../../../../images/home_banner.jpg">
							<table width="100%" height="30" border="0" cellpadding="0"
								cellspacing="0">
								<tr>
									<td class="header"><div align="right">
											<a href="../../../../AboutUs/contact.html"><span
												class="linkwhite">Contact Us</span></a> | <a
												href="../../../../termsofuse.html"><span
												class="linkwhite">Terms of Use</span></a>&nbsp;&nbsp;
										</div></td>
								</tr>
							</table> <!-- InstanceBeginEditable name="Header" -->
							<table width="100%" border="0" cellpadding="0" cellspacing="0">
								<tr>
									<td><img
										src="../../../../images/bannertext_avails-validator.gif"
										alt="Common Metadata" width="600" height="100" /></td>
								</tr>
							</table> <!-- InstanceEndEditable -->
						</td>
					</tr>
				</table>
				<div id="menu-navigation">
					<ul>
						<li><a href="../../../../initiatives/index.html"
							onmouseout="MM_swapImgRestore()"
							onmouseover="MM_swapImage('Initiatives','','../../../../images/nav2/nav_initiatives_RO.gif',1)"><img
								src="../../../../images/nav2/nav_initiatives.gif"
								alt="Initiatives" name="Initiatives" width="200" height="25"
								border="0" id="Initiatives" /></a>
							<ul>
								<li><a href="../../../../initiatives/index.html#NGE">Next-Generation
										Experiences</a></li>
								<li><a href="../../../../initiatives/index.html#ADW">Automated
										Digital Workflows</a></li>
								<li><a href="../../../../initiatives/index.html#BI">Business
										Intelligence</a></li>
							</ul></li>
						<li><a href="#" onmouseout="MM_swapImgRestore()"
							onmouseover="MM_swapImage('SpecsStand','','../../../../images/nav2/nav_specsstandards_RO.gif',1)"><img
								src="../../../../images/nav2/nav_specsstandards.gif" width="200"
								height="25" id="SpecsStand" /></a>
							<ul>
								<li><a href="../../../../ngvideo/index.html">Ultra HD
										&amp; HDR</a></li>
								<li><a href="../../../../ngvideo/index.html">Enhanced
										Content Protection (ECP)</a></li>
								<li><a href="../../../../cpe/index.html">Interactivity
										&amp; Extras</a></li>
								<li><a href="../../../md/index.html">Common Metadata</a></li>
								<li><a href="../../../avails/index.html">Avails – EMA
										Content Availability Metadata</a></li>
								<li><a href="../../index.html">Media Manifest</a></li>
								<li><a href="../../../mmc/index.html">Media Manifest
										Core (MMC)</a></li>
								<li><a href="../../../mec/index.html">Media
										Entertainment Core (MEC) Metadata</a></li>
								<li><a href="../../../ratings/index.html">Ratings</a></li>
								<li><a href="../../../../crmd/index.html">Content
										Recognition Metadata</a></li>
								<li><a href="http://www.acns.net/" target="_blank">Automated
										Content Notification System (ACNS)</a></li>
							</ul></li>
						<li><a href="../../../../PitchUs/index.html"
							onmouseout="MM_swapImgRestore()"
							onmouseover="MM_swapImage('PitchUs','','../../../../images/nav2/nav_pitchus_RO.gif',1)"><img
								src="../../../../images/nav2/nav_pitchus.gif" width="200"
								height="25" id="PitchUs" /></a></li>
						<li><a href="../../../../AboutUs/index.html"
							onmouseout="MM_swapImgRestore()"
							onmouseover="MM_swapImage('About Us','','../../../../images/nav2/nav_aboutus_RO.gif',1)"><img
								src="../../../../images/nav2/nav_aboutus.gif" alt="About Us"
								name="About Us" width="200" height="25" border="0" id="About Us" /></a>
							<ul>
								<li><a href="../../../../AboutUs/team.html">Team</a></li>
								<li><a href="../../../../AboutUs/contact.html">Contact
										Us</a></li>
								<li><a href="../../../../AboutUs/career.html">Career</a></li>
								<li><a href="../../../../News/index.html">News</a></li>
							</ul></li>
					</ul>
				</div></td>
		</tr>
		<tr>
			<td valign="top">
				<!-- InstanceBeginEditable name="Body" -->&nbsp;
				<table width="100%" border="0" cellspacing="0" cellpadding="10">
					<tr>
						<td width="25%" valign="top">
							<!-- #BeginLibraryItem "/Library/LeftNav_Meta.lbi" -->
							<ul class="leftnavbullets">
								<li><a href="http://www.movielabs.com/md">Home</a></li>
								<li><a href="http://www.movielabs.com/md/md">Common
										Metadata</a></li>
								<li><a href="http://www.movielabs.com/md/ratings">Common
										Ratings</a></li>
								<li><a href="http://www.movielabs.com/extras"> Extras
										and Interactivity</a></li>
								<li><a href="http://www.movielabs.com/md/manifest">Media
										Manifest</a></li>
								<li><a href="http://www.movielabs.com/md/mmc">Media
										Manifest Core</a></li>
								<li><a href="http://www.movielabs.com/md/mec">Media
										Entertainment Core</a></li>
								<li><a href="http://www.movielabs.com/md/avails">Avails</a></li>
								<li><a href="http://www.movielabs.com/cpe">Cross
										Platform Extras</a></li>
								<li><a href="http://www.movielabs.com/crmd">Content
										Recognition </a></li>
							</ul> <!-- #EndLibraryItem -->
						</td>
						<td width="75%" valign="top">
							<h1 style="margin-bottom: 10px;" class="title">User's Guide:
								Avails Validator</h1> <tt>Release 1.0</tt>
							<hr />
							<h2 class="title">Contents:</h2> <tt>
								<ol>
									<a href="#OV"><li>Overview</li></a>
									<ol>
										<a href="#OV_f"><li>Functionality</li></a>
										<a href="#OV_ui"><li>User Interface</li></a>
									</ol>
									<a href="#USE"><li>Using the Validator</li></a>
									<ol>
										<a href="#USE_opts"><li>Selecting Processing Options</li></a>
										<a href="#USE_run"><li>Running the Validator and
												Interpreting Output</li></a>
										<a href="#USE_Edit"><li>Editing XML</li></a>

										<ol>
											<a href="#USE_Edit_1"><li>Overview</li></a>
											<a href="#USE_Edit_2"><li>Launching the Editor</li></a>
											<a href="#USE_Edit_3"><li>User Interface</li></a>
											<a href="#USE_Edit_4"><li>Saving Changes and
													Re-Validating</li></a>
										</ol>
										<a href="#USE_2XML"><li>Converting XLSX to XML</li></a>
									</ol>
									<a href="#SCRIPT"><li>Running Scripts</li></a>
									<ol>
										<a href="#SCRIPT_func"><li>Functionality</li></a>
										<a href="#SCRIPT_write"><li>Writing Command Scripts</li></a>
										<a href="#SCRIPT_ui"><li>User Interface</li></a>
									</ol>

								</ol>
							</tt>
							<hr />
							<h2 id="OV" class="title">1) Overview</h2>
							<h3 id="OV_f" class="title">1.1) Functionality</h3>
							<p>
								The
								<tt>Validator</tt>
								is a standalone application that is intended to be used during
								the pre-processing of an <a
									href="http://www.movielabs.com/md/avails/" target="_blank">Avails
									Metadata</a> file. Capabilities include:
								<ul>
									<li>Validates that one or more Avails files are in
										conformance with the Avails specification.</li>
									<li>Validation of Avails file in either XML or XLSX
										format.</li>
									<li>Optional checks for conformance with applicable <i>best
											practices</i> or similar guidance.
									</li>
									<li>Integrated XML Editor with linkage to any errors or
										warnings detected.</li>
									<li>Conversion of XLSX formatted Avails into XML.</li>
									<li>Ability to run in a scripted mode for batch processing
										of multiple files.</li>
									<li>Installers for Windows, Mac OSX, and Linux platforms.</li>
								</ul>
							</p> <!-- ####################################################################### -->
							<h3 id="OV_ui" class="title">1.2) User Interface</h3>
							<div class="imgDiv">
								<img src="./images/ug01.jpg" width="571" height="294"
									style="max-width: 700px;" />
								<p class="imgCaption">Figure 1: Validator UI</p>
							</div> The user interface is shown in Figure 1. From top to bottom, the
							main components are:
							<ul>
								<li>Menus providing access to generic capabilities. The
									primary one is the "Processing" menu. This allows the user to
									select the types of validation checks to be performed and the
									level of logging output desired.</li>
								<li>The Tool Bar, which is used for:
									<ul>
										<li>selection of one or more files to be validated, and</li>
										<li>access to the integrated Manifest Editor.</li>
									</ul>
								</li>
								<li>The Logging panel used to display and filter the
									messages resulting from the validation process</li>
							</ul> <!-- ####################################################################### -->
							<!-- ####################################################################### -->

							<hr />
							<h2 id="USE" class="title">2) Using the Validator</h2>
							<h3 id="USE_opts" class="title">2.1) Selecting Processing
								Options</h3>
							<ol>
								<li>The first step is to configure basic options and
									preferences (e.g., logging output). This is done via the check
									boxes in the <tt>Processing</tt> menu (Fig 2). The user may:
									<ul>
										<li>filter validation-related messages based on their
											severity and</li>
										<li>enable or disable informational and status messages.</li>
									</ul>
								</li>
								<div class="imgDiv">
									<img src="./images/ug02.jpg" style="max-width: 700px;" />
									<p class="imgCaption">Figure 2: Validation Criteria Menu</p>
								</div>
								<li>The next step is to select which files will be
									validated. There are three mechanisms provided:
									<ul>
										<li>Use the <tt>Open File...</tt> menu item to select an
											Avails file in either XML or Excel format <br /> <img
											src="./images/ug02b.jpg"</li>
										<li>The <tt>Recent..</tt> menu item may be used to select
											from a history of recently accessed files.
										</li>
										<li>A <i>left-click</i> on the 'File' text area (to the
											right of the <img src="./images/run.jpg"
											style="vertical-align: middle" , max-height: 10px; "/>
											button) will pop open a File Chooser dialog.
										</li>
									</ul>
									<p>If a directory is selected, all Avails files found in
										the directory will be processed. Alternatively a single file
										may be selected. Note, however, that if the selected source is
										a directory containing multiple Avails files, then all files
										will be validated against the same set of options.</p>
								</li>
								<!--
								<li>If the selected Profile(s) support <i>use cases</i>,
									the user has the option of selecting one or more Use Cases for
									inclusion in the validation process. At this time, the only
									Profile that does support use cases is 'MMC-1'.
								</li>
								  -->
							</ol> <!-- ####################################################################### -->
							<h3 id="USE_run" class="title">2.2) Running the Validator
								and Interpreting Output</h3>
							<p>
								Once all validation options have been set, the validation
								process may be executed via the
								<tt>RUN</tt>
								button. When the validation process completes, the results will
								be displayed in the Logging panel (see Figure 3).
								<div class="imgDiv">
									<img src="./images/ug03.jpg" width="563" />
									<p class="imgCaption">Figure 3: Validation Results</p>
								</div>
								The <i>navigation pane</i> on the left side allows the user to
								select a sub-set of messages to be displayed on the right side.
								Messages are hierarchically grouped first by the Avails file
								they apply to, then by the severity level, and finally by the
								type of validation check resulting in the message (e.g., CMD).
								The levels, in order of decreasing severity, are:
								<ul>
									<li><tt>
											<b>Fatal</b>
										</tt>: Indicates the inability to perform any processing on a file.
										For example, attempting to process an Avails based on an
										unsupported version of the schema would result in a FATAL log
										entry.</li>
									<li><tt>
											<b>Error</b>
										</tt>: a problem that must be corrected. An example would be the
										absence of a required property or the use of an unrecognized
										value for an enumerated type (e.g., an invalid language code)</li>
									<li><tt>
											<b>Warning</b>
										</tt>: a problem or inconsistency that does not have to be
										corrected but may be worth looking into. For example, a
										Transaction with more than one SuppressionLiftDate terms is
										contradictory but may still be processable by a retailer.</li>
									<li><tt>
											<b>Notice</b>
										</tt>: indicates that a recommended <i>Best practice</i> was not
										followed (e.g. the use of non-EIDR ID values for IDs)</li>
									<li><tt>
											<b>Debug</b>
										</tt>: diagnostic output that should only be produced when
										requested by Movie Labs.</li>
								</ul>
								<p>
									The last type of log entry is an
									<tt>
										<b>Info</b>
									</tt>
									message. These are used to provide a user with summary and
									status information about the file being validated. The
									generation of Info messages may be enabled or disabled via the
									<tt>Processing -> Logging</tt>
									menu (see Fig 2 above).
								</p>
								<p>Icons are used to indicate the most severe problem found
									in any branch of the message hierarchy. For example, Figure 3b
									shows that only one of the two files that were processed
									contains errors.</p>
								<div class="imgDiv">
									<img src="./images/ug03b.jpg" />
									<p class="imgCaption">Figure 3b: Severity of Log Messages</p>
								</div>
							</p>
							<p>
								The <i>message display pane</i> on the right provides a table
								showing all the messages in which ever branch of the message
								hierarchy has been selected in the navigation pane. Some log
								messages will provide additional information via <i>tool
									tips</i>. Where possible, this will include references to specific
								sections of the documentation that cover the identified problem.
							</p>
							<p>
								The interpretation of the
								<tt>Line</tt>
								entry will depend on the type of Avails file being processed.
								For XML files it will be the line number in the file while for
								XLSX files it is actually the row number in the sheet being
								processed.
							</p>
							<p>
								The displayed log messages may be sorted by means of a <i>left-click</i>
								on any of the column headers. Subsequent left-clicks will
								reverse the sort order.
							</p>
							<p>
								By <i>right-clicking</i> on the message display pane, a pop-up
								menu may be accessed (see Figure 4). Available actions are:
								<ul>
									<li>show the XML associated with the error in an Editor
										window [for XML-formatted Avails files only],</li>
									<li>clear the entire contents of the message log, or</li>
									<li>save to a file the currently displayed group of
										messages in CSV format</li>
								</ul>
							</p>
							<div class="imgDiv">
								<img src="./images/ug04.jpg" width="535" />
								<p class="imgCaption">Figure 4: Message Log Pop-up Menu</p>
							</div>
							<p>The saving and/or clearing of the log file are simple
								operations and the user interface for both of these is
								self-explanatory. Usage of the Editor is covered in detail in
								the next section.</p> <!-- ####################################################################### -->
							<h3 id="USE_Edit" class="title">2.3) Editing [XML files
								only]</h3>
							<h4 id="USE_Edit_1" class="title">2.3.1) Overview</h4>
							<p>
								The Avails Validator includes a built-in XML Editor that may be
								used to correct any errors found during the validation process.
								Note that this is not intended to provide a full-featured XML
								authoring capability similar to those provided by tools such as
								<a href="http://www.altova.com/xmlspy.html" target="_blank">XML
									Spy</a> or <a href="https://www.oxygenxml.com/xml_editor.html"
									target="_blank">Oxygen-XML</a>. Rather it is focused on
								providing an easy-to-use and integrated capability for quickly
								correcting errors and then re-running the validation tests.
							</p>

							<p>The Editor UI is implemented as a separate window (see
								Figure 5). Multiple Editor windows may be opened at the same
								time, with each displaying a different XML file. Note, however,
								that there may only be one Editor window for any given file.</p>
							<div class="imgDiv">
								<img src="./images/ug05.jpg" width="562" />
								<p class="imgCaption">Figure 5: XML Editor</p>
							</div>
							<h4 id="USE_Edit_2" class="title">2.3.2) Launching the
								Editor</h4>
							<p>There are three ways to launch the XML Editor:</p>
							<ol>
								<li>As described in Section 2..2, an Editor may be launched
									by the context menu displayed when the user right-clicks on a
									log entry. <br />
								<img style="vertical-align: middle" src="./images/ug04b.jpg" />
									<br />The editor will scroll the display to the line associated
									with the log entry.
								</li>
								<li>An Editor may be launched by right-clicking on the file
									name displayed in the <i>navigation pane</i>: <img
									style="vertical-align: middle" src="./images/ug04c.jpg" />.
								</li>
								<li>An Editor may also be launched using the EDIT button in
									the tool bar: <img style="vertical-align: middle"
									src="./images/ug06b.jpg" />
								</li>
							</ol>
							<p>
								When an editor is launched for a specific Avails file:
								<ul>
									<li>if an editor window for the file has not been
										previously accessed, a new Editor will be created and
										displayed.</li>
									<li>if an editor for the file already exists but has been
										minimized (i.e., iconified) by the user, it will be opened and
										brought to the foreground.</li>
									<li>if an editor for the file already exists, it will
										scroll to display the selected line in that file.</li>
									<li>if the log message used to access the editor does not
										have a specific location associated with it, or the editor was
										launched using the Menu Bar, the current line will be set to
										the first line in the file.</li>
								</ul>
							</p>
							<h4 id="USE_Edit_3" class="title">2.3.3) User Interface</h4>
							<p>
								The Editor window has the following components:
								<ul>
									<li>a text pane which uses colors for syntax highlighting,</li>
									<li>a menu bar providing access to the available editing
										functions</li>
									<li>line numbers displayed on the left edge that includes
										markers indicating errors and warnings, and</li>
									<li>display of status messages across the bottom of the
										editor window.</li>
								</ul>
								These are shown in Figure 6.
							</p>
							<div class="imgDiv">
								<img src="./images/ug06.jpg" width="512" height="265" />
								<p class="imgCaption">Figure 6: Editor UI</p>
							</div>
							<p>The status messages are linked to the marker icons
								displayed along side the line numbers. A single left or right
								click on a marker will result in the associated log entry being
								displayed in the status panel.</p>
							<h4 id="USE_Edit_4" class="title">2.3.4) Saving Changes and
								Re-Validating</h4>
							<p>
								To save changes, simply use either the pull down menu or the
								<tt>&lt;Ctrl&gt;S</tt>
								shortcut. Once the Avails file has been saved the XML may be
								re-validated.
							</p>
							<p>
								The changed Avails may also be saved under a new name using the
								<tt>Save As</tt>
								menu option. If the Avails is saved under a new name then the
								user must explicitly identify the new Avails file as the
								Validator's
								<tt style="color: #0000dd;">Source</tt>
								before it can be validated. Also it is important to remember
								that the <u>existing</u> Editor window will still be displaying
								the original Avails file. In order to edit the newly saved file,
								the user must:
								<ol>
									<li>select the new file as the source file to validate,</li>
									<li>run the validation, and then</li>
									<li>select one of the resulting log messages to open an
										Editor window for the new XML file.</li>
								</ol>
							</p>
							<h3 id="USE_2XML" class="title">2.4) Conversion to XML [XLSX
								files only]</h3> Whenever an XLSX formatted Avails file is processed,
							an XML version of the same information will automatically be
							generated and saved. The key points to note are:
							<ul>
								<li>The XML file will be saved in the same directory as the
									Excel file it was generated from.</li>
								<li>The generated XML <b style="color: #ff0000;">may
										not be valid</b> in that any problems or issues present in the
									XLSX will also be present in the XML version.
								</li>
								<li>The XML will conform to the most recent version of the
									Avails schema that is supported by mddf-lib. Currently that is
									v2.2</li>
							</ul> <!-- ####################################################################### -->
							<!-- ####################################################################### -->
							<hr />
							<h2 id="SCRIPT" class="title">3) Running Scripts</h2>
							<h3 id="SCRIPT_func" class="title">3.1) Functionality</h3>
							<p>Validation of multiple Avails files may be performed using
								scripts that can specify any of same options and settings
								available thru the user interface. A script may easily be used
								to process a set of manifests with specified sub-sets being
								handled using different options. All results are automatically
								displayed in the GUI's log display but the script engine
								supports the option of also writing the log to a file.</p>
							<h3 id="SCRIPT_write" class="title">3.2) Writing Command
								Scripts</h3>
							<h4 id="SCRIPT_struct" class="title">3.2.1) Structure</h4>
							<p>
								A script file is written using the <a
									href="http://www.json.org/" target="_blank">JSON</a> syntax.
								The structure for a <i>validation</i> script is as follows:
							</p>
							<ul>
								<li>Command: should be specified as <tt>validate</tt> . The
									validation command has OPTIONAL sub-elements followed by a list
									of files to process.

									<ul>
										<li>Options in the following sub-elements will apply to
											all files that will be processed. These are:
											<ul>
												<li><p>
														<tt>pathPrefix</tt>
														: [OPTIONAL] a root folder for locating all Avails files.
														The path may be absolute or relative. If relative, the
														location of the script file is the starting point for
														resolving the full path to each file or folder. If a
														<tt>pathPrefix</tt>
														is <i>not</i> specified, the present working directory
														will be used as the starting point for resolving the full
														path to each file or folder.
													</p></li>

												<li><p>
														<tt>logging</tt>
														:
														<ul>
															<li><p>
																	<tt>level</tt>
																	: [OPTIONAL] the minimum level of messages to be
																	included in the output log. Allowed values are:<br />
																	<tt>{ "Verbose", "Warning", "Error", "Info"}</tt>
																	<br />The default when not specified is
																	<tt>Warning</tt>
																	.
																</p></li>

															<li><p>
																	<tt>output</tt>
																	: [OPTIONAL] file to write the log to. If not
																	specified, the log is not saved. The path may be
																	absolute or relative. If relative, the location of the
																	script file is the starting point for resolving the
																	full path.
																</p></li>
														</ul>
											</ul>
											<li><p>A set of XML-formatted Avails files to be
													processed. These are specified as a JSON Array. Properties
													are:</p>
												<ul>
													<li><p>
															<tt>file</tt>
															: [REQUIRED] Path to a either a file or a directory
															containing one or more files. If relative, the starting
															point for resolving the full path is the
															<tt>pathPrefix</tt>
															.
														</p></li>
												</ul></li>
									</ul></li>
							</ul>
							<h4 id="SCRIPT_ex" class="title">3.2.2) Examples</h4>
							<p>The following is an example of script that validates two
								files plus any additional Avails found in a specific folder and
								then saves the message log in a single output file:</p> <pre>
{  
  "validate":{  
    "pathPrefix":"./AvailsDemos/",
    "logging":{  
      "level":"Warning",
      "output":"./scriptLog01.xml"
      },
    "avails":[  
      {  
        "file":"si_tests/CMM_BBB_v0.1.xml" 
      },
      {  
        "file":"si_tests/CMM_Sita_v0.1.xml" 
      },
      {  
        "file":"studioFoo" 
      }
      ]
    }
}
	</pre>

							<p>
								The next two examples illustrate the use, or non-use, of the
								<tt>pathPrefix</tt>
								. In the first example, all relative paths are resolved using
								the present working directory as the base. Both
								<tt>foo1.xml</tt>
								and
								<tt>foo2.xml</tt>
								should therefore be in the
								<tt>pwd</tt>
								.
							</p> <pre>
{  
  "validate":{   
    "avails":[
      {  
        "file":"foo1.xml" 
      },
      {  
        "file":"./foo2.xml" 
      },
      {  
        "file":"/foo3.xml" 
      }
    ]
  }
}
	</pre>
							<p>
								In the next example,
								<tt>foo1.xml</tt>
								and
								<tt>foo2.xml</tt>
								are still co-located but are now in in a sub-directory of the
								directory containing the script file.
								<tt>foo3.xml</tt>
								should still be in the same location as the previous examples
								since it is specified using an absolute path.
							</p> <pre>
{  
  "validate":{   
    "pathPrefix":"./AvailsDemos/",
    "avails":[
      {  
        "file":"foo1.xml" 
      },
      {  
        "file":"./foo2.xml" 
      },
      {  
        "file":"/foo3.xml" 
      }
    ]
  }
}
	</pre>

							<h3 id="SCRIPT_ui" class="title">3.3) User Interface</h3>
							<p>
								Selection and execution of a script is via the
								<tt>Run Script..</tt>
								menu entry. Script files are <b>not</b> selectable using the
								<tt>File</tt>
								text-entry field used to specify an Avails XML file.
							</p>
							<p>Once a script file has been selected the execution is
								automatic. It is recommended that the contents of the log
								display be cleared prior to executing a script. Failure to do so
								will result in any previous messages being included in the saved
								log file.</p>
							<div class="imgDiv">
								<img src="./images/ug07.jpg" />
								<p class="imgCaption">Figure 7: Script Selection and
									Execution</p>
							</div>
						</td>
					</tr>
				</table>
				<table width="100%" border="0" cellspacing="0" cellpadding="0">
					<tr>
						<td>&nbsp;</td>
					</tr>
				</table> <!-- InstanceEndEditable -->
			</td>
		</tr>
		<tr>
			<td class="footer"><div align="center">
					<hr width="100%" size="1" />
					<p>
						<a href="../../../../AboutUs/contact.html">Contact Us</a> | <a
							href="../../../../termsofuse.html">Terms of Use</a> | <a
							href="../../../../privacy.html">Privacy Policy</a><br /> &copy;
						2016 Motion Picture Laboratories, Inc. All rights reserved.<br />
						<br /> <br />
					</p>
				</div></td>
		</tr>
	</table>
</body>
<!-- InstanceEnd -->
</html>